~~~~ r
require(compareGroups)

require(dplyr)






load("~/Dropbox/SyncBriefcase/LAB/IACS/AWHS/R_analysis/TABLAS/tE.Rdata")

tE=subset(tE,!is.na(gen)&!is.na(num.ms))


####define la variable 'dosis de alelo E4'
tE$e4[tE$gen%in%c('E2E2','E2E3','E3E3')]='00'
####tE$e4[tE$gen%in%c('E3E4')]='01'
tE$e4[tE$gen%in%c('E2E4','E3E4')]='01'
tE$e4[tE$gen%in%c('E4E4')]='11'
tE$e4=as.factor(tE$e4)



tE$num.ms=ifelse(tE$num.ms%in%c('3','4','5'),'3+',tE$num.ms)
tE$num.ms2=ifelse(tE$num.ms2%in%c('3','4','5'),'3+',tE$num.ms2)
tE$num.ms3=ifelse(tE$num.ms3%in%c('3','4','5'),'3+',tE$num.ms3)

tE[,63:77]=lapply(tE[,63:77],as.factor)
~~~~

PREVALENCIA DE SINDROME METABOLICO {#prevalencia-de-sindrome-metabolico}
----------------------------------

### Segun donde se tenga en cuenta la medicacion hipolipemiante {#segun-donde-se-tenga-en-cuenta-la-medicacion-hipolipemiante}

~~~~ r
######################POBLACION TOTAL
t2=compareGroups(e4~waist.ms+hta.ms+glu.ms+tg.ms+hdl.ms+num.ms+metS
                   ,data=tE)
t3=compareGroups(e4~tg.ms2+hdl.ms2+num.ms2+metS2
                 ,data=tE)
t4=compareGroups(e4~tg.ms3+hdl.ms3+num.ms3+metS3
                 ,data=tE)

c2=createTable(t2,show.p.trend=T,hide.no=0,show.ratio=T)
c3=createTable(t3,show.p.trend=T,hide.no=0,show.ratio=T)
c4=createTable(t4,show.p.trend=T,hide.no=0,show.ratio=T)

tot=rbind('Hypolip. in HDL criterion'=c2,'Hypolip. in TG criterion'=c3,'Hypolip. NOT considered'=c4)###une las tablas
tot
~~~~

    ## 
    ## --------Summary descriptives table by 'e4'---------
    ## 
    ## __________________________________________________________________ 
    ##                   00          01          11     p.overall p.trend 
    ##                 N=3631       N=787       N=41                      
    ## ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
    ## Hypolip. in HDL criterion:
    ##     waist.ms 1119 (30.8%) 229 (29.1%) 17 (41.5%)   0.202    0.815  
    ##     hta.ms   2027 (55.8%) 442 (56.2%) 26 (63.4%)   0.617    0.576  
    ##     glu.ms   1393 (38.4%) 327 (41.6%) 18 (43.9%)   0.204    0.075  
    ##     tg.ms    1293 (35.6%) 284 (36.1%) 21 (51.2%)   0.115    0.277  
    ##     hdl.ms   641 (17.7%)  171 (21.7%) 14 (34.1%)   0.001   <0.001  
    ##     num.ms:                                        0.400    0.030  
    ##         0    712 (19.6%)  142 (18.0%) 4 (9.76%)                    
    ##         1    944 (26.0%)  194 (24.7%) 10 (24.4%)                   
    ##         2    904 (24.9%)  202 (25.7%) 10 (24.4%)                   
    ##         3+   1071 (29.5%) 249 (31.6%) 17 (41.5%)                   
    ##     metS     1071 (29.5%) 249 (31.6%) 17 (41.5%)   0.134    0.080  
    ## Hypolip. in TG criterion:
    ##     tg.ms2   1441 (39.7%) 334 (42.4%) 25 (61.0%)   0.009    0.016  
    ##     hdl.ms2  341 (9.39%)  89 (11.3%)  7 (17.1%)    0.074    0.032  
    ##     num.ms2:                                       0.207    0.043  
    ##         0    716 (19.7%)  143 (18.2%) 4 (9.76%)                    
    ##         1    957 (26.4%)  201 (25.5%) 12 (29.3%)                   
    ##         2    929 (25.6%)  204 (25.9%) 7 (17.1%)                    
    ##         3+   1029 (28.3%) 239 (30.4%) 18 (43.9%)                   
    ##     metS2    1029 (28.3%) 239 (30.4%) 18 (43.9%)   0.053    0.054  
    ## Hypolip. NOT considered:
    ##     tg.ms3   1293 (35.6%) 284 (36.1%) 21 (51.2%)   0.115    0.277  
    ##     hdl.ms3  341 (9.39%)  89 (11.3%)  7 (17.1%)    0.074    0.032  
    ##     num.ms3:                                       0.711    0.120  
    ##         0    736 (20.3%)  148 (18.8%) 5 (12.2%)                    
    ##         1    974 (26.8%)  209 (26.6%) 11 (26.8%)                   
    ##         2    942 (25.9%)  208 (26.4%) 10 (24.4%)                   
    ##         3+   979 (27.0%)  222 (28.2%) 15 (36.6%)                   
    ##     metS3    979 (27.0%)  222 (28.2%) 15 (36.6%)   0.314    0.228  
    ## ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

' Por categorias de BMI {#por-categorias-de-bmi}
-----------------------

~~~~ r
#############################POR CATEGORIAS DE BMI

t5=compareGroups(e4~waist.ms+hta.ms+glu.ms+tg.ms+hdl.ms+num.ms+metS+tg.ms2+hdl.ms2+num.ms2+metS2+tg.ms3+hdl.ms3+num.ms3+metS3
                 ,data=tE,subset = bmi<25)

t6=compareGroups(e4~waist.ms+hta.ms+glu.ms+tg.ms+hdl.ms+num.ms+metS+tg.ms2+hdl.ms2+num.ms2+metS2+tg.ms3+hdl.ms3+num.ms3+metS3
                 ,data=tE,subset = bmi>=25&bmi<30)

t7=compareGroups(e4~waist.ms+hta.ms+glu.ms+tg.ms+hdl.ms+num.ms+metS+tg.ms2+hdl.ms2+num.ms2+metS2+tg.ms3+hdl.ms3+num.ms3+metS3
                 ,data=tE,subset = bmi>=30)
c5=createTable(t5,show.p.trend=T,hide.no=0,show.ratio=T)
c6=createTable(t6,show.p.trend=T,hide.no=0,show.ratio=T)
c7=createTable(t7,show.p.trend=T,hide.no=0,show.ratio=T)
~~~~

### Normal weight {#normal-weight}

~~~~ r
c5
~~~~

    ## 
    ## --------Summary descriptives table by 'e4'---------
    ## 
    ## ___________________________________________________________ 
    ##              00          01        11     p.overall p.trend 
    ##             N=796      N=179       N=8                      
    ## ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
    ## waist.ms  1 (0.13%)  0 (0.00%)  0 (0.00%)   1.000    0.636  
    ## hta.ms   272 (34.2%) 67 (37.4%) 1 (12.5%)   0.318    0.804  
    ## glu.ms   190 (23.9%) 49 (27.4%) 2 (25.0%)   0.564    0.358  
    ## tg.ms    155 (19.5%) 33 (18.4%) 3 (37.5%)   0.370    0.831  
    ## hdl.ms   76 (9.55%)  20 (11.2%) 4 (50.0%)   0.006    0.040  
    ## num.ms:                                     0.316    0.197  
    ##     0    353 (44.3%) 70 (39.1%) 1 (12.5%)                   
    ##     1    257 (32.3%) 65 (36.3%) 4 (50.0%)                   
    ##     2    129 (16.2%) 30 (16.8%) 3 (37.5%)                   
    ##     3+   57 (7.16%)  14 (7.82%) 0 (0.00%)                   
    ## metS     57 (7.16%)  14 (7.82%) 0 (0.00%)   0.863    0.980  
    ## tg.ms2   169 (21.2%) 40 (22.3%) 5 (62.5%)   0.030    0.164  
    ## hdl.ms2  48 (6.03%)  7 (3.91%)  1 (12.5%)   0.251    0.488  
    ## num.ms2:                                    0.144    0.330  
    ##     0    355 (44.6%) 71 (39.7%) 1 (12.5%)                   
    ##     1    259 (32.5%) 66 (36.9%) 6 (75.0%)                   
    ##     2    128 (16.1%) 30 (16.8%) 0 (0.00%)                   
    ##     3+   54 (6.78%)  12 (6.70%) 1 (12.5%)                   
    ## metS2    54 (6.78%)  12 (6.70%) 1 (12.5%)   0.575    0.830  
    ## tg.ms3   155 (19.5%) 33 (18.4%) 3 (37.5%)   0.370    0.831  
    ## hdl.ms3  48 (6.03%)  7 (3.91%)  1 (12.5%)   0.251    0.488  
    ## num.ms3:                                    0.458    0.650  
    ##     0    359 (45.1%) 72 (40.2%) 2 (25.0%)                   
    ##     1    257 (32.3%) 67 (37.4%) 5 (62.5%)                   
    ##     2    134 (16.8%) 32 (17.9%) 1 (12.5%)                   
    ##     3+   46 (5.78%)  8 (4.47%)  0 (0.00%)                   
    ## metS3    46 (5.78%)  8 (4.47%)  0 (0.00%)   0.739    0.365  
    ## ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

### Overweight {#overweight}

~~~~ r
c6
~~~~

    ## 
    ## --------Summary descriptives table by 'e4'---------
    ## 
    ## ______________________________________________________________ 
    ##               00          01          11     p.overall p.trend 
    ##             N=1974       N=429       N=20                      
    ## ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
    ## waist.ms 380 (19.3%)  77 (17.9%)  6 (30.0%)    0.350    0.939  
    ## hta.ms   1128 (57.1%) 247 (57.6%) 13 (65.0%)   0.772    0.668  
    ## glu.ms   742 (37.6%)  184 (42.9%) 7 (35.0%)    0.117    0.080  
    ## tg.ms    705 (35.7%)  159 (37.1%) 9 (45.0%)    0.612    0.414  
    ## hdl.ms   333 (16.9%)  97 (22.6%)  5 (25.0%)    0.012    0.004  
    ## num.ms:                                        0.318    0.021  
    ##     0    336 (17.0%)  68 (15.9%)  2 (10.0%)                    
    ##     1    606 (30.7%)  113 (26.3%) 5 (25.0%)                    
    ##     2    573 (29.0%)  131 (30.5%) 6 (30.0%)                    
    ##     3+   459 (23.3%)  117 (27.3%) 7 (35.0%)                    
    ## metS     459 (23.3%)  117 (27.3%) 7 (35.0%)    0.098    0.038  
    ## tg.ms2   792 (40.1%)  188 (43.8%) 11 (55.0%)   0.161    0.071  
    ## hdl.ms2  162 (8.21%)  50 (11.7%)  3 (15.0%)    0.036    0.013  
    ## num.ms2:                                       0.325    0.018  
    ##     0    338 (17.1%)  68 (15.9%)  2 (10.0%)                    
    ##     1    616 (31.2%)  119 (27.7%) 5 (25.0%)                    
    ##     2    595 (30.1%)  130 (30.3%) 6 (30.0%)                    
    ##     3+   425 (21.5%)  112 (26.1%) 7 (35.0%)                    
    ## metS2    425 (21.5%)  112 (26.1%) 7 (35.0%)    0.044    0.015  
    ## tg.ms3   705 (35.7%)  159 (37.1%) 9 (45.0%)    0.612    0.414  
    ## hdl.ms3  162 (8.21%)  50 (11.7%)  3 (15.0%)    0.036    0.013  
    ## num.ms3:                                       0.622    0.065  
    ##     0    354 (17.9%)  72 (16.8%)  2 (10.0%)                    
    ##     1    631 (32.0%)  126 (29.4%) 5 (25.0%)                    
    ##     2    592 (30.0%)  131 (30.5%) 8 (40.0%)                    
    ##     3+   397 (20.1%)  100 (23.3%) 5 (25.0%)                    
    ## metS3    397 (20.1%)  100 (23.3%) 5 (25.0%)    0.282    0.122  
    ## ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

### Obese {#obese}

~~~~ r
c7
~~~~

    ## 
    ## --------Summary descriptives table by 'e4'---------
    ## 
    ## _____________________________________________________________ 
    ##              00          01          11     p.overall p.trend 
    ##             N=841       N=176       N=13                      
    ## ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
    ## waist.ms 735 (87.4%) 151 (85.8%) 11 (84.6%)   0.695    0.527  
    ## hta.ms   615 (73.1%) 126 (71.6%) 12 (92.3%)   0.311    0.703  
    ## glu.ms   453 (53.9%) 92 (52.3%)  9 (69.2%)    0.494    0.844  
    ## tg.ms    430 (51.1%) 89 (50.6%)  9 (69.2%)    0.423    0.615  
    ## hdl.ms   228 (27.1%) 52 (29.5%)  5 (38.5%)    0.481    0.320  
    ## num.ms:                                       0.745    0.991  
    ##     0    19 (2.26%)   4 (2.27%)  1 (7.69%)                    
    ##     1    74 (8.80%)  16 (9.09%)  1 (7.69%)                    
    ##     2    198 (23.5%) 41 (23.3%)  1 (7.69%)                    
    ##     3+   550 (65.4%) 115 (65.3%) 10 (76.9%)                   
    ## metS     550 (65.4%) 115 (65.3%) 10 (76.9%)   0.773    0.688  
    ## tg.ms2   475 (56.5%) 103 (58.5%) 9 (69.2%)    0.591    0.387  
    ## hdl.ms2  129 (15.3%) 32 (18.2%)  3 (23.1%)    0.434    0.245  
    ## num.ms2:                                      0.755    0.958  
    ##     0    19 (2.26%)   4 (2.27%)  1 (7.69%)                    
    ##     1    75 (8.92%)  16 (9.09%)  1 (7.69%)                    
    ##     2    202 (24.0%) 43 (24.4%)  1 (7.69%)                    
    ##     3+   545 (64.8%) 113 (64.2%) 10 (76.9%)                   
    ## metS2    545 (64.8%) 113 (64.2%) 10 (76.9%)   0.740    0.761  
    ## tg.ms3   430 (51.1%) 89 (50.6%)  9 (69.2%)    0.423    0.615  
    ## hdl.ms3  129 (15.3%) 32 (18.2%)  3 (23.1%)    0.434    0.245  
    ## num.ms3:                                      0.743    0.864  
    ##     0    19 (2.26%)   4 (2.27%)  1 (7.69%)                    
    ##     1    78 (9.27%)  16 (9.09%)  1 (7.69%)                    
    ##     2    212 (25.2%) 44 (25.0%)  1 (7.69%)                    
    ##     3+   532 (63.3%) 112 (63.6%) 10 (76.9%)                   
    ## metS3    532 (63.3%) 112 (63.6%) 10 (76.9%)   0.647    0.572  
    ## ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

~~~~ r
tot=cbind('Normal Weight'=c5,'Overweight'=c6,'Obese'=c7)###une las tablas
~~~~
